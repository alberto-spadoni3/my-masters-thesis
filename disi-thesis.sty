\usepackage[italian]{babel}
\usepackage[hyperfootnotes=true]{hyperref}
\usepackage{graphicx}
\usepackage{amssymb,amsmath}
\usepackage[italian]{cleveref}
\usepackage{geometry}
\usepackage{titling}
\usepackage[inline]{enumitem}
\usepackage{setspace}
\usepackage{fancyhdr}

\fancypagestyle{plain}{
  \fancyhf{}
  \fancyfoot[RE,LO]{\leftmark}
  \fancyfoot[LE,RO]{\thepage}
  \renewcommand{\footrulewidth}{1pt}
}

\fancypagestyle{fancy}{
  \fancyhf{}
  \fancyhead[CE,CO]{\rightmark}
  \fancyfoot[RE,LO]{\leftmark}
  \fancyfoot[LE,RO]{\thepage}
  \renewcommand{\headrulewidth}{1pt}
  \renewcommand{\footrulewidth}{1pt}
  \setlength{\headheight}{14.49998pt}
  \addtolength{\topmargin}{-2.49998pt}
}

\pagestyle{fancy}

\newcommand{\acknowledgementsname}{Acknowledgements}

\newcommand{\school}[1]{\def\theschool{#1}}
\newcommand{\department}[1]{\def\thedepartment{#1}}
\newcommand{\programme}[1]{\def\theprogramme{#1}}
\newcommand{\subject}[1]{\def\thesubject{#1}}
\newcommand{\cosupervisor}[1]{\def\thecosupervisor{#1}}
\newcommand{\morecosupervisor}[1]{\def\themorecosupervisor{#1}}
\newcommand{\supervisor}[1]{\def\thesupervisor{#1}}
\newcommand{\session}[1]{\def\thesession{#1}}
\newcommand{\academicyear}[1]{\def\theacademicyear{#1}}

\newenvironment{abstract}{
\chapter*{\centering\abstractname}\addcontentsline{toc}{chapter}{\abstractname}}{}
\newenvironment{acknowledgements}{
  \cleardoublepage % Forza una nuova pagina e resetta il footer
  \chapter*{\acknowledgementsname}
  \markboth{\MakeUppercase{\acknowledgementsname}}{\MakeUppercase{\acknowledgementsname}} % Aggiorna header
  \addcontentsline{toc}{chapter}{\acknowledgementsname} % Aggiunge ai TOC
}{}

\newenvironment{dedication}{
  \chapter*{}
\begin{flushright}\itshape}{\normalfont
\end{flushright}}
\newenvironment{inlinelist}{
\begin{enumerate*}[label=\emph{(\roman{*})}]}{
\end{enumerate*}}

\newcommand{\chapterWithoutNumber}[1]{
\chapter*{#1}\addcontentsline{toc}{chapter}{#1}}

\let\oldbibliography\bibliography
\renewcommand{\bibliography}[1]{
  \addcontentsline{toc}{part}{}
  \addcontentsline{toc}{chapter}{\bibname}
  \oldbibliography{#1}
}

\def\themainlinespacing{1}
\newcommand{\mainlinespacing}[1]{\def\themainlinespacing{#1}}
\let\oldmainmatter\mainmatter
\renewcommand{\mainmatter}{
  \oldmainmatter
  % \onehalfspacing % https://tex.stackexchange.com/questions/30073/why-is-the-linespread-factor-as-it-is
  \setstretch{\themainlinespacing}
}

\newcommand{\frontispiece}{
  \newgeometry{margin=0.7in}
  \begin{titlepage}
    \centering
    \large

    \includegraphics[width=0.4\textwidth]{figures/logo-unibo-original.pdf}
    \vspace{1cm}

    \thedepartment
    \\
    \noindent\hrulefill
    \vspace{0.2cm}

    \Large
    \theprogramme

    \Huge
    \vspace{2.6cm}
    \textbf{
      \thetitle
    }

    \large
    \vspace{1cm}
    Tesi di laurea in:
    \\
    \textsc{\thesubject}

    \vspace{2.6cm}
    %
    \begin{minipage}[t]{0.64\textwidth}
      \begin{flushleft}
        \textit{Relatore}
        \\
        \textbf{\thesupervisor}
        \\
        \vspace{0.4cm}
        \ifdefined\thecosupervisor
        \ifdefined\themorecosupervisor
        \textit{Correlatori}
        \\
        \textbf{\thecosupervisor}
        \\
        \textbf{\themorecosupervisor}
        \else
        \textit{Correlatore}
        \\
        \textbf{\thecosupervisor}
        \fi
        \fi
      \end{flushleft}
    \end{minipage}
    %
    \begin{minipage}[t]{0.34\textwidth}
      \begin{flushright}
        \textit{Candidato}
        \\
        \textbf{\theauthor}
      \end{flushright}
    \end{minipage}
    \\

    \vfill
    \noindent\hrulefill
    \vspace{0.3cm}
    \Large

    \thesession{} Sessione di Laurea
    \\
    Anno Accademico \theacademicyear
  \end{titlepage}
  \restoregeometry
}
